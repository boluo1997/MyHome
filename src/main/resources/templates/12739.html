<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>pygame快速上手 | 丁生的个人博客</title><meta name="description" content="开始你的第一个 python 小游戏——pygame快速上手"><meta name="keywords" content="python,pygame"><meta name="author" content="丁生"><meta name="copyright" content="丁生"><meta name="format-detection" content="telephone=no"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="https://hm.baidu.com"><link rel="preconnect" href="http://ta.qq.com"><link rel="preconnect" href="https://fonts.googleapis.com" crossorigin="crossorigin"><link rel="preconnect" href="//busuanzi.ibruce.info"><meta name="baidu-site-verification" content="wIDbD23BFA"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="pygame快速上手"><meta name="twitter:description" content="开始你的第一个 python 小游戏——pygame快速上手"><meta name="twitter:image" content="static/image/FmqHTOS6Nz4b9jo.jpg"><meta property="og:type" content="article"><meta property="og:title" content="pygame快速上手"><meta property="og:url" content="http://fabian4.gitee.io/12739.html"><meta property="og:site_name" content="丁生的个人博客"><meta property="og:description" content="开始你的第一个 python 小游戏——pygame快速上手"><meta property="og:image" content="static/image/FmqHTOS6Nz4b9jo.jpg"><script src="static/js/js.cookie.min.js"></script><script>var autoChangeMode = 'false'
var t = Cookies.get("theme")
if (autoChangeMode == '1'){
  var isDarkMode = window.matchMedia("(prefers-color-scheme: dark)").matches
  var isLightMode = window.matchMedia("(prefers-color-scheme: light)").matches
  var isNotSpecified = window.matchMedia("(prefers-color-scheme: no-preference)").matches
  var hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

  if (t === undefined){
    if (isLightMode) activateLightMode()
    else if (isDarkMode) activateDarkMode()
    else if (isNotSpecified || hasNoSupport){
      console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
      var now = new Date()
      var hour = now.getHours()
      var isNight = hour < 6 || hour >= 18
      isNight ? activateDarkMode() : activateLightMode()
  }
  } else if (t == 'light') activateLightMode()
  else activateDarkMode()

} else if (autoChangeMode == '2'){
  now = new Date();
  hour = now.getHours();
  isNight = hour < 6 || hour >= 18
  if(t === undefined) isNight? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode() 
} else {
  if ( t == 'dark' ) activateDarkMode()
  else if ( t == 'light') activateLightMode()
}

function activateDarkMode(){
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null){
    document.querySelector('meta[name="theme-color"]').setAttribute('content','#000')
  }
}
function activateLightMode(){
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null){
  document.querySelector('meta[name="theme-color"]').setAttribute('content','#fff')
  }
}</script><link rel="stylesheet" href="static/css/index.css"><link rel="stylesheet" href="static/css/font-awesome.min.css"><link rel="stylesheet" href="static/css/jquery.fancybox.min.css"><link rel="stylesheet" href="static/css/snackbar.min.css"><link rel="canonical" href=""><link rel="prev" title="pygame常用函数" href="12400.html"><link rel="next" title="白嫖阿里——搭建自己的个人服务器" href="64086.html"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?21649d9cdb2cd4f62daa5d692e743c0a";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><script src="static/js/stats-66550846.js" charset="UTF-8"></script><link rel="stylesheet" href="static/css/css-TitilliumWeb.css"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"cookieDomain":"http://fabian4.gitee.io/","msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  bookmark: {
    message_prev: '按',
    message_next: '键将本页加入书签'
  },
  runtime_unit: '天',
  runtime: true,
  copyright: undefined,
  ClickShowText: undefined,
  medium_zoom: false,
  fancybox: true,
  Snackbar: {"bookmark":{"message_prev":"按","message_next":"键将本页加入书签"},"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#2d3035","position":"bottom-left"},
  baiduPush: true,
  highlightCopy: true,
  highlightLang: true,
  highlightShrink: 'false',
  isFontAwesomeV5: false,
  isPhotoFigcaption: false
  
}</script><script>var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isSidebar: true  
  }</script><noscript><style>
#page-header {
  opacity: 1
}
.justified-gallery img{
  opacity: 1
}
</style></noscript><meta name="generator" content="Hexo 4.2.0"></head><body><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="static/picture/ZWnOQA3kUGKXSjJ.jpg" onerror="onerror=null;src='https://i.loli.net/2020/04/24/LOgyfbeXRjSCGP3.gif'" alt="avatar"></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="index1.html"><div class="headline">文章</div><div class="length_num">15</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="index2.html"><div class="headline">标签</div><div class="length_num">8</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="index3.html"><div class="headline">分类</div><div class="length_num">6</div></a></div></div></div><hr><div class="menus_items"><div class="menus_item"><a class="site-page" href="index.html"><i class="fa-fw fa fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="index1.html"><i class="fa-fw fa fa-archive"></i><span> 文章</span></a></div><div class="menus_item"><a class="site-page" href="index2.html"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="index3.html"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div></div></div></div><i class="fa fa-arrow-right on" id="toggle-sidebar" aria-hidden="true">     </i><div id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#开始你的第一个-python-小游戏——pygame快速上手"><span class="toc-number">1.</span> <span class="toc-text">开始你的第一个 python 小游戏——pygame快速上手</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#pygame"><span class="toc-number">1.1.</span> <span class="toc-text">pygame</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#一、游戏的基本逻辑和游戏循环"><span class="toc-number">1.2.</span> <span class="toc-text">一、游戏的基本逻辑和游戏循环</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#二、模块划分和框架的构建"><span class="toc-number">1.3.</span> <span class="toc-text">二、模块划分和框架的构建</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#main-py-用于控制整个游戏循环和游戏的开始和结束"><span class="toc-number">1.3.1.</span> <span class="toc-text">main.py    用于控制整个游戏循环和游戏的开始和结束</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#sprite-py-用于我们创建角色，敌人之类的游戏元素"><span class="toc-number">1.3.2.</span> <span class="toc-text">sprite.py   用于我们创建角色，敌人之类的游戏元素</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#settings-py-用于来专门放置我们游戏中的参数，起到一个配置类的作用"><span class="toc-number">1.3.3.</span> <span class="toc-text">settings.py  用于来专门放置我们游戏中的参数，起到一个配置类的作用</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#三、角色、阶梯的创建"><span class="toc-number">1.4.</span> <span class="toc-text">三、角色、阶梯的创建</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#角色类"><span class="toc-number">1.4.1.</span> <span class="toc-text">角色类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#阶梯类"><span class="toc-number">1.4.2.</span> <span class="toc-text">阶梯类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#加入sprite组件"><span class="toc-number">1.4.3.</span> <span class="toc-text">加入sprite组件</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#四、定义碰撞和重力效果"><span class="toc-number">1.5.</span> <span class="toc-text">四、定义碰撞和重力效果</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#坐标系"><span class="toc-number">1.5.1.</span> <span class="toc-text">坐标系</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#加入重力"><span class="toc-number">1.5.2.</span> <span class="toc-text">加入重力</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#定义碰撞"><span class="toc-number">1.5.3.</span> <span class="toc-text">定义碰撞</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#五、角色的左右移动和跳跃"><span class="toc-number">1.6.</span> <span class="toc-text">五、角色的左右移动和跳跃</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#移动"><span class="toc-number">1.6.1.</span> <span class="toc-text">移动</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#跳跃"><span class="toc-number">1.6.2.</span> <span class="toc-text">跳跃</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#六、屏幕的滚动"><span class="toc-number">1.7.</span> <span class="toc-text">六、屏幕的滚动</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#七、细节的处理和完善"><span class="toc-number">1.8.</span> <span class="toc-text">七、细节的处理和完善</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#长按和短按空格达成不一样的跳跃效果"><span class="toc-number">1.8.1.</span> <span class="toc-text">长按和短按空格达成不一样的跳跃效果</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#加入一个角色死亡效果"><span class="toc-number">1.8.2.</span> <span class="toc-text">加入一个角色死亡效果</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#开始和结束屏幕的绘制"><span class="toc-number">1.8.3.</span> <span class="toc-text">开始和结束屏幕的绘制</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#八、程序打包"><span class="toc-number">1.9.</span> <span class="toc-text">八、程序打包</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#九、源码"><span class="toc-number">1.10.</span> <span class="toc-text">九、源码</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#main-py"><span class="toc-number">1.10.1.</span> <span class="toc-text">main.py</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#sprites-py"><span class="toc-number">1.10.2.</span> <span class="toc-text">sprites.py</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#settings-py"><span class="toc-number">1.10.3.</span> <span class="toc-text">settings.py</span></a></li></ol></li></ol></li></ol></div></div></div><div id="body-wrap"><div id="web_bg" data-type="photo"></div><div class="post-bg" id="nav" style="background-image: url(static/image/FmqHTOS6Nz4b9jo.jpg)"><div id="page-header"><span class="pull_left" id="blog_name"><a class="blog_title" id="site-name" href="index.html">丁生的个人博客</a></span><span class="pull_right menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="index.html"><i class="fa-fw fa fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="index1.html"><i class="fa-fw fa fa-archive"></i><span> 文章</span></a></div><div class="menus_item"><a class="site-page" href="index2.html"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="index3.html"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div></div><span class="toggle-menu close"><a class="site-page"><i class="fa fa-bars fa-fw" aria-hidden="true"></i></a></span></span></div><div id="post-info"><div id="post-title"><div class="posttitle">pygame快速上手</div></div><div id="post-meta"><div class="meta-firstline"><time class="post-meta__date" title="发表于 2020-04-27 00:00:00"><i class="fa fa-calendar" aria-hidden="true"></i> 发表于 2020-04-27</time><span class="post-meta__categories"><span class="post-meta__separator">|</span><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="index4.html">python</a></span></div><div class="meta-secondline"> <span class="post-meta-wordcount"><i class="post-meta__icon fa fa-file-word-o" aria-hidden="true"></i><span>字数总计:</span><span class="word-count">3.6k</span><span class="post-meta__separator">|</span><i class="post-meta__icon fa fa-clock-o" aria-hidden="true"></i><span>阅读时长: 16 分钟</span></span></div><div class="meta-thirdline"><span class="post-meta-pv-cv"><span class="post-meta__separator">|</span><i class="fa fa-eye post-meta__icon" aria-hidden="true"> </i><span>阅读量:</span><span id="busuanzi_value_page_pv"></span></span><span class="post-meta-commentcount"><span class="post-meta__separator">|</span><i class="post-meta__icon fa fa-comment-o" aria-hidden="true"></i><span>评论数:</span><a href="#post-comment" itemprop="discussionUrl"><span class="valine-comment-count comment-count" data-xid="/12739.html" itemprop="commentCount"></span></a></span></div></div></div></div><main class="layout_post" id="content-inner"><article id="post"><div id="article-container"><h1 id="开始你的第一个-python-小游戏——pygame快速上手"><a href="#开始你的第一个-python-小游戏——pygame快速上手" class="headerlink" title="开始你的第一个 python 小游戏——pygame快速上手"></a>开始你的第一个 python 小游戏——pygame快速上手</h1><h2 id="pygame"><a href="#pygame" class="headerlink" title="pygame"></a>pygame</h2><p>​        pygame作为一款优秀的python第三方库，包含了很多游戏方面的函数。今天我们就开始来快速上手做一个自己的小游戏。这里是 <a href="javascript:;" target="_blank" rel="noopener">pygame官网</a> 和 <a href="javascript:;" target="_blank" rel="noopener">官方文档</a>，下面是游戏的效果图</p>
<img src="static/picture/OVzAJZRNjLMB82U.gif" class="lazyload" data-src="https://i.loli.net/2020/04/26/ZmMVSek4cqFJ2zw.gif" alt="jumpy !.gif" style="zoom:25%;">

<ul>
<li>在使用 pygame 的同时，可以帮我们更好的熟悉python的语法，为后面的爬虫、web和数据分析学习做铺垫</li>
<li>这个游戏中涉及的一些基本的角色移动跳跃和碰撞，也是大家开始编写自己的小游戏的基础</li>
<li>pyinstaller 也是一个在打包脚本，跨平台使用的便捷方式</li>
<li>游戏的素材和代码来自于油管，大家一起共同学习和借鉴</li>
</ul>
<h2 id="一、游戏的基本逻辑和游戏循环"><a href="#一、游戏的基本逻辑和游戏循环" class="headerlink" title="一、游戏的基本逻辑和游戏循环"></a>一、游戏的基本逻辑和游戏循环</h2><p>下面是一个游戏的最基本的流程</p>
<ul>
<li>游戏开始</li>
<li>游戏循环<ol>
<li>监听鼠标键盘事件</li>
<li>更新元素的状态</li>
<li>绘制屏幕</li>
</ol>
</li>
<li>游戏结束</li>
</ul>
<p>而根据游戏的基本流程，下面就是一个很常用的模板，根据模板来将这个这个游戏的流程更加具象</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pygame</span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义窗口大小和FPS</span></span><br><span class="line">WIDTH = <span class="number">360</span></span><br><span class="line">HEIGHT = <span class="number">400</span></span><br><span class="line">FPS = <span class="number">30</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义颜色</span></span><br><span class="line">WHITE = (<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>)</span><br><span class="line">BLACK = (<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line">RED = (<span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line">GREEN = (<span class="number">0</span>, <span class="number">255</span>, <span class="number">0</span>)</span><br><span class="line">BLUE = (<span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 初始化pygame</span></span><br><span class="line">pygame.init()</span><br><span class="line"><span class="comment"># 初始化声音组件</span></span><br><span class="line">pygame.mixier.init()</span><br><span class="line"><span class="comment"># 根据长宽创建窗口</span></span><br><span class="line">screen = pygame.display.set_mode([WIDTH, HEIGHT])</span><br><span class="line"><span class="comment"># 窗口展示游戏的名字</span></span><br><span class="line">pygame.display.set_caption(<span class="string">"My Game"</span>)</span><br><span class="line">clock = pygame.time.Clock()</span><br><span class="line"></span><br><span class="line">all_sprites = pygame.sprite.Group()</span><br><span class="line"><span class="comment"># 游戏循环</span></span><br><span class="line">running = <span class="literal">True</span></span><br><span class="line"><span class="keyword">while</span> running:</span><br><span class="line">	<span class="comment"># 保持一定速度</span></span><br><span class="line">	clock.tick(FPS)</span><br><span class="line">	<span class="comment"># 事件输入</span></span><br><span class="line">	<span class="keyword">for</span> event <span class="keyword">in</span> pygame.event.get():</span><br><span class="line">		<span class="comment"># 检查是否关闭窗口</span></span><br><span class="line">		<span class="keyword">if</span> event.type == pygame.QUIT:</span><br><span class="line">			running = <span class="literal">False</span></span><br><span class="line">	<span class="comment"># 更新状态</span></span><br><span class="line">	all_sprites.update()</span><br><span class="line"></span><br><span class="line">	<span class="comment"># 绘制窗口</span></span><br><span class="line">	screen.fill(BLACK)</span><br><span class="line">	all_sprites.draw(screen)</span><br><span class="line">	pygame.display.flip()</span><br><span class="line"></span><br><span class="line">pygame.quit()</span><br></pre></td></tr></table></figure>

<h2 id="二、模块划分和框架的构建"><a href="#二、模块划分和框架的构建" class="headerlink" title="二、模块划分和框架的构建"></a>二、模块划分和框架的构建</h2><p>有了上面的模板我们就可以开始我们的游戏创作了，然而随着我们游戏的逻辑的复杂，代码全部挤在一个文件中很明显就不利于我们的后期改进和调整，在这里我们将其拆分为大致三个文件：</p>
<h3 id="main-py-用于控制整个游戏循环和游戏的开始和结束"><a href="#main-py-用于控制整个游戏循环和游戏的开始和结束" class="headerlink" title="main.py    用于控制整个游戏循环和游戏的开始和结束"></a>main.py    用于控制整个游戏循环和游戏的开始和结束</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> sprites <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Game</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="comment"># 初始化窗口</span></span><br><span class="line">        <span class="comment"># 初始化pygame创建窗口</span></span><br><span class="line">        pg.init()</span><br><span class="line">        self.screen = pg.display.set_mode([WIDTH, HEIGHT])</span><br><span class="line">        pg.display.set_caption(TITLE)</span><br><span class="line">        self.clock = pg.time.Clock()</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">new</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="comment"># 创建游戏所需的对象</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">run</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="comment"># 游戏循环</span></span><br><span class="line">        self.playing = <span class="literal">True</span></span><br><span class="line">        <span class="keyword">while</span> self.playing:</span><br><span class="line">            self.clock.tick(FPS)</span><br><span class="line">            self.events()</span><br><span class="line">            self.update()</span><br><span class="line">            self.draw()</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">update</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="comment"># 更新状态</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">events</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="comment"># 检测响应事件</span></span><br><span class="line">        <span class="keyword">for</span> event <span class="keyword">in</span> pg.event.get():</span><br><span class="line">            <span class="comment"># 检查是否关闭窗口</span></span><br><span class="line">            <span class="keyword">if</span> event.type == pg.QUIT:</span><br><span class="line">                <span class="keyword">if</span> self.playing:</span><br><span class="line">                    self.playing = <span class="literal">False</span></span><br><span class="line">                self.running = <span class="literal">False</span></span><br><span class="line">   <span class="function"><span class="keyword">def</span> <span class="title">draw</span><span class="params">(self)</span>:</span></span><br><span class="line">    	<span class="comment"># 绘制窗口</span></span><br><span class="line">        self.screen.fill(BACKGROUND_COLOR)</span><br><span class="line">        self.all_sprites.draw(self.screen)</span><br><span class="line">        pg.display.flip()</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">show_start_screen</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="comment"># 展示开始屏幕</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">show_go_screen</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="comment"># 展示结束屏幕</span></span><br><span class="line">        </span><br><span class="line">g = Game()</span><br><span class="line">g.show_start_screen()</span><br><span class="line"><span class="keyword">while</span> g.running:</span><br><span class="line">    g.new()</span><br><span class="line">    g.show_go_screen()</span><br></pre></td></tr></table></figure>

<h3 id="sprite-py-用于我们创建角色，敌人之类的游戏元素"><a href="#sprite-py-用于我们创建角色，敌人之类的游戏元素" class="headerlink" title="sprite.py   用于我们创建角色，敌人之类的游戏元素"></a>sprite.py   用于我们创建角色，敌人之类的游戏元素</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> settings <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> pygame <span class="keyword">as</span> pg</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Player</span><span class="params">(pg.sprite.Sprite)</span>:</span></span><br><span class="line">    <span class="comment"># 角色类</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Platform</span><span class="params">(pg.sprite.Sprite)</span>:</span></span><br><span class="line">    <span class="comment"># 阶梯类</span></span><br></pre></td></tr></table></figure>

<h3 id="settings-py-用于来专门放置我们游戏中的参数，起到一个配置类的作用"><a href="#settings-py-用于来专门放置我们游戏中的参数，起到一个配置类的作用" class="headerlink" title="settings.py  用于来专门放置我们游戏中的参数，起到一个配置类的作用"></a>settings.py  用于来专门放置我们游戏中的参数，起到一个配置类的作用</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 定义游戏名字</span></span><br><span class="line">TITLE = <span class="string">"Jumpy !"</span></span><br><span class="line"><span class="comment"># 定义窗口大小和FPS</span></span><br><span class="line">WIDTH = <span class="number">400</span></span><br><span class="line">HEIGHT = <span class="number">600</span></span><br><span class="line">FPS = <span class="number">60</span></span><br><span class="line"><span class="comment"># 定义颜色</span></span><br><span class="line">WHITE = (<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>)</span><br><span class="line">BLACK = (<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line">RED = (<span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line">GREEN = (<span class="number">0</span>, <span class="number">255</span>, <span class="number">0</span>)</span><br><span class="line">BLUE = (<span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>)</span><br><span class="line">YELLOW = (<span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>)</span><br><span class="line">BACKGROUND_COLOR = (<span class="number">0</span>, <span class="number">155</span>, <span class="number">155</span>)</span><br><span class="line"><span class="comment"># 阶梯的位置</span></span><br><span class="line">PLATFORM_LIST = [(WIDTH / <span class="number">2</span> - <span class="number">30</span>, HEIGHT * <span class="number">0.8</span>, <span class="number">150</span>, <span class="number">20</span>),</span><br><span class="line">                 (<span class="number">25</span>, HEIGHT - <span class="number">350</span>, <span class="number">100</span>, <span class="number">20</span>),</span><br><span class="line">                 (<span class="number">350</span>, <span class="number">200</span>, <span class="number">100</span>, <span class="number">20</span>),</span><br><span class="line">                 (<span class="number">175</span>, <span class="number">100</span>, <span class="number">50</span>, <span class="number">20</span>)]</span><br></pre></td></tr></table></figure>

<h2 id="三、角色、阶梯的创建"><a href="#三、角色、阶梯的创建" class="headerlink" title="三、角色、阶梯的创建"></a>三、角色、阶梯的创建</h2><p>​        在pygame中有一个很重要的类就是<code>sprite</code>类，可以说是所有元素类的父类，为每一种元素创建一个类继承该类，并将所有创建的元素注册到<code>sprite</code>的组件中。</p>
<h3 id="角色类"><a href="#角色类" class="headerlink" title="角色类"></a>角色类</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Player</span><span class="params">(pg.sprite.Sprite)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, game)</span>:</span></span><br><span class="line">        pg.sprite.Sprite.__init__(self)</span><br><span class="line">        self.image = pg.Surface((<span class="number">30</span>, <span class="number">40</span>))</span><br><span class="line">        self.image.fill(YELLOW) </span><br><span class="line">        <span class="comment"># 角色为一个黄色的方块</span></span><br><span class="line">        self.rect = self.image.get_rect()</span><br><span class="line">        self.rect.center = (WIDTH / <span class="number">2</span>, HEIGHT / <span class="number">2</span>)</span><br><span class="line">        self.pos = vec(WIDTH / <span class="number">2</span>, HEIGHT / <span class="number">2</span>)</span><br><span class="line">        <span class="comment"># 角色的初始位置</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">update</span><span class="params">(self)</span>:</span></span><br></pre></td></tr></table></figure>

<h3 id="阶梯类"><a href="#阶梯类" class="headerlink" title="阶梯类"></a>阶梯类</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Platform</span><span class="params">(pg.sprite.Sprite)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, x, y, w, h)</span>:</span></span><br><span class="line">        pg.sprite.Sprite.__init__(self)</span><br><span class="line">        self.image = pg.Surface((w, h))</span><br><span class="line">        self.image.fill(GREEN)</span><br><span class="line">        <span class="comment"># 填充绿色</span></span><br><span class="line">        self.rect = self.image.get_rect()</span><br><span class="line">        self.rect.x = x</span><br><span class="line">        self.rect.y = y</span><br></pre></td></tr></table></figure>

<h3 id="加入sprite组件"><a href="#加入sprite组件" class="headerlink" title="加入sprite组件"></a>加入<code>sprite</code>组件</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">new</span><span class="params">(self)</span>:</span></span><br><span class="line">        self.all_sprites = pg.sprite.Group()</span><br><span class="line">        self.platforms = pg.sprite.Group()</span><br><span class="line">        self.player = Player(self)</span><br><span class="line">        self.all_sprites.add(self.player)</span><br><span class="line">        self.ground = Platform(<span class="number">0</span>, HEIGHT - <span class="number">20</span>, WIDTH, <span class="number">20</span>)</span><br><span class="line">        self.all_sprites.add(self.ground)</span><br><span class="line">        self.platforms.add(self.ground)</span><br><span class="line">        <span class="keyword">for</span> plat <span class="keyword">in</span> PLATFORM_LIST:</span><br><span class="line">            p = Platform(*plat)</span><br><span class="line">            self.all_sprites.add(p)</span><br><span class="line">            self.platforms.add(p)</span><br></pre></td></tr></table></figure>

<h2 id="四、定义碰撞和重力效果"><a href="#四、定义碰撞和重力效果" class="headerlink" title="四、定义碰撞和重力效果"></a>四、定义碰撞和重力效果</h2><h3 id="坐标系"><a href="#坐标系" class="headerlink" title="坐标系"></a>坐标系</h3><p>在这之前要先简单的说明一下pygame中对坐标的定义，即顶点在游戏窗口左上角的直角坐标系。他的正方向分别是向右和向下的。所以比如当角色要向上跳跃的时候<strong>参数应该是负的</strong></p>
<img src="https://i.loli.net/2020/04/27/tiExBwSvADjqcQY.png" style="zoom: 33%;">

<h3 id="加入重力"><a href="#加入重力" class="headerlink" title="加入重力"></a>加入重力</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 在角色类中定义</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">update</span><span class="params">(self)</span>:</span></span><br><span class="line">    	<span class="comment"># 加入重力效果</span></span><br><span class="line">        self.acc = vec(<span class="number">0</span>, PLAYER_GRAVITY)</span><br></pre></td></tr></table></figure>

<p>但是运行游戏之后你会发现小方块会不停的下落直接穿过了我们定义的”地面”</p>
<h3 id="定义碰撞"><a href="#定义碰撞" class="headerlink" title="定义碰撞"></a>定义碰撞</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 在整个游戏类中定义</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">update</span><span class="params">(self)</span>:</span></span><br><span class="line">        self.all_sprites.update()</span><br><span class="line">        <span class="comment"># 确保只有角色是在向下落的时候撞到平台才能站在平台上</span></span><br><span class="line">        <span class="keyword">if</span> self.player.vel.y &gt; <span class="number">0</span>:</span><br><span class="line">            hits = pg.sprite.spritecollide(self.player, self.platforms, <span class="literal">False</span>)</span><br><span class="line">            <span class="keyword">if</span> hits:</span><br><span class="line">                <span class="keyword">if</span> self.player.pos.y &lt; hit[<span class="number">0</span>].rect.bottom:</span><br><span class="line">                    self.player.pos.y = hit[<span class="number">0</span>].rect.top</span><br><span class="line">                    self.player.vel.y = <span class="number">0</span></span><br><span class="line">                self.player.jumping = <span class="literal">False</span></span><br></pre></td></tr></table></figure>

<p>碰撞类是pygame中另一个比较重要的函数，角色的很多操作和状态都会涉及到</p>
<h2 id="五、角色的左右移动和跳跃"><a href="#五、角色的左右移动和跳跃" class="headerlink" title="五、角色的左右移动和跳跃"></a>五、角色的左右移动和跳跃</h2><h3 id="移动"><a href="#移动" class="headerlink" title="移动"></a>移动</h3><p>在我们对角色进行左右移动的操作时，绝不能仅仅的只是角色的速度向左和向右的增加。而应该对他的加速度参数进行调整，并且加上一定的阻力，这样角色才不会一直运动下去，确保速度存在一个峰值。这其中就涉及到了运动学的公式，毕竟这个公式是可以约束地球上所有的物体的，不然整个游戏给人的感觉就会有失违和。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">update</span><span class="params">(self)</span>:</span></span><br><span class="line">    	<span class="comment"># 加入重力效果</span></span><br><span class="line">        self.acc = vec(<span class="number">0</span>, PLAYER_GRAVITY)</span><br><span class="line">        keys = pg.key.get_pressed()</span><br><span class="line">        <span class="keyword">if</span> keys[pg.K_LEFT]:</span><br><span class="line">            self.acc.x = -PLAYER_ACC</span><br><span class="line">        <span class="keyword">if</span> keys[pg.K_RIGHT]:</span><br><span class="line">            self.acc.x = PLAYER_ACC</span><br><span class="line">        <span class="comment"># 增加摩擦</span></span><br><span class="line">        self.acc.x += self.vel.x * PLAYER_FRICTION</span><br><span class="line">        <span class="comment"># 移动公式</span></span><br><span class="line">        self.vel += self.acc</span><br><span class="line">        self.pos += self.vel + <span class="number">0.5</span> * self.acc</span><br><span class="line">        <span class="comment"># 让角色保持在屏幕里</span></span><br><span class="line">        <span class="keyword">if</span> self.pos.x &gt; WIDTH:</span><br><span class="line">            self.pos.x = <span class="number">0</span></span><br><span class="line">        <span class="keyword">if</span> self.pos.x &lt; <span class="number">0</span>:</span><br><span class="line">            self.pos.x = WIDTH</span><br></pre></td></tr></table></figure>

<h3 id="跳跃"><a href="#跳跃" class="headerlink" title="跳跃"></a>跳跃</h3><p>对于角色的跳跃操作我们也需要加以一些公式的约束从而使其达到一个合理的地球表面的跳跃效果</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">jump</span><span class="params">(self)</span>:</span></span><br><span class="line">       <span class="comment"># 引入一个角色是否在跳跃状态的判断，防止出现角色可以在空中一直跳跃类似起飞的效果</span></span><br><span class="line">       <span class="keyword">if</span> <span class="keyword">not</span> self.jumping:</span><br><span class="line">           self.jumping = <span class="literal">True</span></span><br><span class="line">           self.vel.y = -PLAYER_JUMP</span><br></pre></td></tr></table></figure>

<h2 id="六、屏幕的滚动"><a href="#六、屏幕的滚动" class="headerlink" title="六、屏幕的滚动"></a>六、屏幕的滚动</h2><ul>
<li>正如前面一开始的gif中所展示的样子，随着小方块的不断的上移，我们整个游戏的所覆盖的画面也应该向上移动。当由于屏幕是不可能如我们所要求的样子向上滚动的，所以我们采用<strong>让背景相对向下移动</strong>来达到同样的效果</li>
<li>随着屏幕的不断上移我们就要不断的来产生新的台阶来让我们这个游戏继续下去，这里用了随机生成的方式</li>
<li>当越来越多的台阶的产生无疑对我们真的游戏的运行来说是一种负担，尤其是那些已经滚动到屏幕下方的台阶，虽然已经不在我们的视野里面，但依然存在我们的内存里。这里我们就需要清楚哪些已经没用的台阶</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 定义在游戏类中</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">update</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="comment"># 向上滚动屏幕即背景下移</span></span><br><span class="line">        <span class="keyword">if</span> self.player.rect.top &lt;= HEIGHT * <span class="number">0.4</span>:</span><br><span class="line">            self.player.pos.y += abs(int(self.player.vel.y))</span><br><span class="line">            <span class="keyword">for</span> plat <span class="keyword">in</span> self.platforms:</span><br><span class="line">                plat.rect.y += abs(int(self.player.vel.y))</span><br><span class="line">                <span class="keyword">if</span> plat.rect.top &gt; HEIGHT:</span><br><span class="line">                    plat.kill()</span><br><span class="line">                    <span class="comment"># 当有台阶在屏幕的下方被清除就加分</span></span><br><span class="line">                    self.score += <span class="number">10</span></span><br><span class="line">        <span class="comment"># 产生新平面</span></span><br><span class="line">        <span class="keyword">while</span> len(self.platforms) &lt; <span class="number">6</span>:</span><br><span class="line">            width = random.randrange(<span class="number">50</span>, <span class="number">100</span>)</span><br><span class="line">            p = Platform(random.randrange(<span class="number">0</span>, WIDTH - width),</span><br><span class="line">                         random.randrange(<span class="number">-75</span>, <span class="number">-30</span>),</span><br><span class="line">                         width, <span class="number">20</span>)</span><br><span class="line">            self.platforms.add(p)</span><br><span class="line">            self.all_sprites.add(p)</span><br></pre></td></tr></table></figure>

<h2 id="七、细节的处理和完善"><a href="#七、细节的处理和完善" class="headerlink" title="七、细节的处理和完善"></a>七、细节的处理和完善</h2><h3 id="长按和短按空格达成不一样的跳跃效果"><a href="#长按和短按空格达成不一样的跳跃效果" class="headerlink" title="长按和短按空格达成不一样的跳跃效果"></a>长按和短按空格达成不一样的跳跃效果</h3><p>这里需要对键盘的按下和松开即<code>KEYDOWN</code>和<code>KEYUP</code>进行监控，同时引入跳跃的状态来控制</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 定义在游戏类中</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">events</span><span class="params">(self)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> event.type == pg.KEYDOWN:</span><br><span class="line">        <span class="keyword">if</span> event.key == pg.K_SPACE:</span><br><span class="line">            self.player.jump()</span><br><span class="line">    <span class="keyword">if</span> event.type == pg.KEYUP:</span><br><span class="line">        <span class="keyword">if</span> event.key == pg.K_SPACE:</span><br><span class="line">            self.player.jump_cut()</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 定义在角色类中</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">jump</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> self.jumping:</span><br><span class="line">            self.jumping = <span class="literal">True</span></span><br><span class="line">            self.vel.y = -PLAYER_JUMP</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">jump_cut</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> self.jumping:</span><br><span class="line">            <span class="keyword">if</span> self.vel.y &lt; <span class="number">-3</span>:</span><br><span class="line">                self.vel.y = <span class="number">-3</span></span><br></pre></td></tr></table></figure>

<h3 id="加入一个角色死亡效果"><a href="#加入一个角色死亡效果" class="headerlink" title="加入一个角色死亡效果"></a>加入一个角色死亡效果</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 定义在游戏类中</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">update</span><span class="params">(self)</span>:</span></span><br><span class="line">       <span class="comment"># 当角色落入屏幕下方时，就回滚还剩下的屏幕下方的台阶</span></span><br><span class="line">        <span class="keyword">if</span> self.player.rect.bottom &gt; HEIGHT:</span><br><span class="line">            <span class="keyword">for</span> sprite <span class="keyword">in</span> self.all_sprites:</span><br><span class="line">                sprite.rect.y -= int(max(self.player.vel.y, <span class="number">10</span>))</span><br><span class="line">                <span class="keyword">if</span> sprite.rect.bottom &lt; <span class="number">0</span>:</span><br><span class="line">                    sprite.kill()</span><br><span class="line">        <span class="keyword">if</span> len(self.platforms) == <span class="number">0</span>:</span><br><span class="line">            self.playing = <span class="literal">False</span></span><br></pre></td></tr></table></figure>

<h3 id="开始和结束屏幕的绘制"><a href="#开始和结束屏幕的绘制" class="headerlink" title="开始和结束屏幕的绘制"></a>开始和结束屏幕的绘制</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 定义在游戏类中</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">show_start_screen</span><span class="params">(self)</span>:</span></span><br><span class="line">    	<span class="comment"># 绘制开始屏幕</span></span><br><span class="line">        self.screen.fill(BACKGROUND_COLOR)</span><br><span class="line">        self.draw_text(TITLE, <span class="number">48</span>, WHITE, WIDTH*<span class="number">0.5</span>, HEIGHT*<span class="number">0.25</span>)</span><br><span class="line">        self.draw_text(<span class="string">"Arrows to move, Space to jump"</span>, <span class="number">22</span>, WHITE, WIDTH*<span class="number">0.5</span>, HEIGHT*<span class="number">0.5</span>)</span><br><span class="line">        self.draw_text(<span class="string">"Press a key to play"</span>, <span class="number">22</span>, WHITE, WIDTH * <span class="number">0.5</span>, HEIGHT * <span class="number">0.75</span>)</span><br><span class="line">        pg.display.flip()</span><br><span class="line">        self.wait_for_key()</span><br><span class="line"></span><br><span class="line"> <span class="function"><span class="keyword">def</span> <span class="title">show_go_screen</span><span class="params">(self)</span>:</span></span><br><span class="line">    	<span class="comment"># 绘制结束屏幕</span></span><br><span class="line">        self.screen.fill(BACKGROUND_COLOR)</span><br><span class="line">        self.draw_text(<span class="string">"Congratulations !"</span>, <span class="number">48</span>, WHITE, WIDTH * <span class="number">0.5</span>, HEIGHT * <span class="number">0.25</span>)</span><br><span class="line">        self.draw_text(<span class="string">"Score: "</span> + str(self.score), <span class="number">22</span>, WHITE, WIDTH * <span class="number">0.5</span>, HEIGHT * <span class="number">0.5</span>)</span><br><span class="line">        self.draw_text(<span class="string">"Press a key to play again"</span>, <span class="number">22</span>, WHITE, WIDTH * <span class="number">0.5</span>, HEIGHT * <span class="number">0.75</span>)</span><br><span class="line">        pg.display.flip()</span><br><span class="line">        self.wait_for_key()</span><br><span class="line"></span><br><span class="line"> <span class="function"><span class="keyword">def</span> <span class="title">wait_for_key</span><span class="params">(self)</span>:</span></span><br><span class="line">    	<span class="comment"># 等待玩家确认</span></span><br><span class="line">        self.waiting = <span class="literal">True</span></span><br><span class="line">        <span class="keyword">while</span> self.waiting:</span><br><span class="line">            self.clock.tick(FPS)</span><br><span class="line">            <span class="keyword">for</span> event <span class="keyword">in</span> pg.event.get():</span><br><span class="line">                <span class="keyword">if</span> event.type == pg.QUIT:</span><br><span class="line">                    self.waiting = <span class="literal">False</span></span><br><span class="line">                    self.running = <span class="literal">False</span></span><br><span class="line">                <span class="keyword">if</span> event.type == pg.KEYDOWN:</span><br><span class="line">                    self.waiting = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"> <span class="function"><span class="keyword">def</span> <span class="title">draw_text</span><span class="params">(self, text, size, color, x, y)</span>:</span></span><br><span class="line">    	<span class="comment"># 屏幕上绘制文字</span></span><br><span class="line">        font = pg.font.SysFont(<span class="string">"arial"</span>, size)</span><br><span class="line">        text_surface = font.render(text, <span class="literal">True</span>, color)</span><br><span class="line">        text_rect = text_surface.get_rect()</span><br><span class="line">        text_rect.midtop = (int(x), int(y))</span><br><span class="line">        self.screen.blit(text_surface, text_rect)</span><br></pre></td></tr></table></figure>

<h2 id="八、程序打包"><a href="#八、程序打包" class="headerlink" title="八、程序打包"></a>八、程序打包</h2><p>​        当你编写完一个小程序肯定迫切的想分享给朋友们去试一下，但不是大家的电脑上都有python环境，这里就需要我们来使用<strong><code>pyinstaller</code></strong>来对我们的程序进行打包</p>
<ol>
<li><p>使用<code>pip</code>安装 <code>pyinstaller</code>（如果安装速度太慢可以配置一下镜像）</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install pyinstaller</span><br></pre></td></tr></table></figure>
</li>
<li><p>进入程序所处目录开始打包</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pyinstaller -F -w main.py</span><br></pre></td></tr></table></figure>

<ul>
<li><code>-F</code>：只生产一个exe文件</li>
<li><code>-w</code>：不创建cmd命令窗口，直接进入游戏窗口</li>
</ul>
</li>
<li><p>然后你就可以去 disc 目录下找到你的exe文件分享给你的朋友们了</p>
</li>
</ol>
<h2 id="九、源码"><a href="#九、源码" class="headerlink" title="九、源码"></a>九、源码</h2><h3 id="main-py"><a href="#main-py" class="headerlink" title="main.py"></a>main.py</h3>  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> sprites <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Game</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="comment"># 初始化窗口</span></span><br><span class="line">        <span class="comment"># 初始化pygame创建窗口</span></span><br><span class="line">        pg.init()</span><br><span class="line">        <span class="comment"># pygame.mixier.init()</span></span><br><span class="line">        self.screen = pg.display.set_mode([WIDTH, HEIGHT])</span><br><span class="line">        pg.display.set_caption(TITLE)</span><br><span class="line">        self.clock = pg.time.Clock()</span><br><span class="line">        self.running = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">new</span><span class="params">(self)</span>:</span></span><br><span class="line">        self.score = <span class="number">0</span></span><br><span class="line">        self.all_sprites = pg.sprite.Group()</span><br><span class="line">        self.platforms = pg.sprite.Group()</span><br><span class="line">        self.player = Player(self)</span><br><span class="line">        self.all_sprites.add(self.player)</span><br><span class="line">        self.ground = Platform(<span class="number">0</span>, HEIGHT - <span class="number">20</span>, WIDTH, <span class="number">20</span>)</span><br><span class="line">        self.all_sprites.add(self.ground)</span><br><span class="line">        self.platforms.add(self.ground)</span><br><span class="line">        <span class="keyword">for</span> plat <span class="keyword">in</span> PLATFORM_LIST:</span><br><span class="line">            p = Platform(*plat)</span><br><span class="line">            self.all_sprites.add(p)</span><br><span class="line">            self.platforms.add(p)</span><br><span class="line">        self.run()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">run</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="comment"># 游戏循环</span></span><br><span class="line">        self.playing = <span class="literal">True</span></span><br><span class="line">        <span class="keyword">while</span> self.playing:</span><br><span class="line">            self.clock.tick(FPS)</span><br><span class="line">            self.events()</span><br><span class="line">            self.update()</span><br><span class="line">            self.draw()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">update</span><span class="params">(self)</span>:</span></span><br><span class="line">        self.all_sprites.update()</span><br><span class="line">        <span class="keyword">if</span> self.player.vel.y &gt; <span class="number">0</span>:</span><br><span class="line">            hits = pg.sprite.spritecollide(self.player, self.platforms, <span class="literal">False</span>)</span><br><span class="line">            <span class="keyword">if</span> hits:</span><br><span class="line">                lowest = hits[<span class="number">0</span>]</span><br><span class="line">                <span class="keyword">for</span> hit <span class="keyword">in</span> hits:</span><br><span class="line">                    <span class="keyword">if</span> hit.rect.bottom &gt; lowest.rect.centery:</span><br><span class="line">                        lowest = hit</span><br><span class="line">                <span class="keyword">if</span> self.player.pos.y &lt; lowest.rect.bottom:</span><br><span class="line">                    self.player.pos.y = lowest.rect.top</span><br><span class="line">                    self.player.vel.y = <span class="number">0</span></span><br><span class="line">                self.player.jumping = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># 向上滚动屏幕即背景下移</span></span><br><span class="line">        <span class="keyword">if</span> self.player.rect.top &lt;= HEIGHT * <span class="number">0.4</span>:</span><br><span class="line">            self.player.pos.y += abs(int(self.player.vel.y))</span><br><span class="line">            <span class="keyword">for</span> plat <span class="keyword">in</span> self.platforms:</span><br><span class="line">                plat.rect.y += abs(int(self.player.vel.y))</span><br><span class="line">                <span class="keyword">if</span> plat.rect.top &gt; HEIGHT:</span><br><span class="line">                    plat.kill()</span><br><span class="line">                    self.score += <span class="number">10</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> self.player.rect.bottom &gt; HEIGHT:</span><br><span class="line">            <span class="keyword">for</span> sprite <span class="keyword">in</span> self.all_sprites:</span><br><span class="line">                sprite.rect.y -= int(max(self.player.vel.y, <span class="number">10</span>))</span><br><span class="line">                <span class="keyword">if</span> sprite.rect.bottom &lt; <span class="number">0</span>:</span><br><span class="line">                    sprite.kill()</span><br><span class="line">        <span class="keyword">if</span> len(self.platforms) == <span class="number">0</span>:</span><br><span class="line">            self.playing = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># 产生新平面</span></span><br><span class="line">        <span class="keyword">while</span> len(self.platforms) &lt; <span class="number">6</span>:</span><br><span class="line">            width = random.randrange(<span class="number">50</span>, <span class="number">100</span>)</span><br><span class="line">            p = Platform(random.randrange(<span class="number">0</span>, WIDTH - width),</span><br><span class="line">                         random.randrange(<span class="number">-75</span>, <span class="number">-30</span>),</span><br><span class="line">                         width, <span class="number">20</span>)</span><br><span class="line">            self.platforms.add(p)</span><br><span class="line">            self.all_sprites.add(p)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">events</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">for</span> event <span class="keyword">in</span> pg.event.get():</span><br><span class="line">            <span class="comment"># 检查是否关闭窗口</span></span><br><span class="line">            <span class="keyword">if</span> event.type == pg.QUIT:</span><br><span class="line">                <span class="keyword">if</span> self.playing:</span><br><span class="line">                    self.playing = <span class="literal">False</span></span><br><span class="line">                self.running = <span class="literal">False</span></span><br><span class="line">            <span class="keyword">if</span> event.type == pg.KEYDOWN:</span><br><span class="line">                <span class="keyword">if</span> event.key == pg.K_SPACE:</span><br><span class="line">                    self.player.jump()</span><br><span class="line">            <span class="keyword">if</span> event.type == pg.KEYUP:</span><br><span class="line">                <span class="keyword">if</span> event.key == pg.K_SPACE:</span><br><span class="line">                    self.player.jump_cut()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">draw</span><span class="params">(self)</span>:</span></span><br><span class="line">        self.screen.fill(BACKGROUND_COLOR)</span><br><span class="line">        self.all_sprites.draw(self.screen)</span><br><span class="line">        self.draw_text(str(self.score)+<span class="string">"  score"</span>, <span class="number">22</span>, WHITE, WIDTH / <span class="number">2</span>, <span class="number">25</span>)</span><br><span class="line">        pg.display.flip()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">show_start_screen</span><span class="params">(self)</span>:</span></span><br><span class="line">        self.screen.fill(BACKGROUND_COLOR)</span><br><span class="line">        self.draw_text(TITLE, <span class="number">48</span>, WHITE, WIDTH*<span class="number">0.5</span>, HEIGHT*<span class="number">0.25</span>)</span><br><span class="line">        self.draw_text(<span class="string">"Arrows to move, Space to jump"</span>, <span class="number">22</span>, WHITE, WIDTH*<span class="number">0.5</span>, HEIGHT*<span class="number">0.5</span>)</span><br><span class="line">        self.draw_text(<span class="string">"Press a key to play"</span>, <span class="number">22</span>, WHITE, WIDTH * <span class="number">0.5</span>, HEIGHT * <span class="number">0.75</span>)</span><br><span class="line">        pg.display.flip()</span><br><span class="line">        self.wait_for_key()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">show_go_screen</span><span class="params">(self)</span>:</span></span><br><span class="line">        self.screen.fill(BACKGROUND_COLOR)</span><br><span class="line">        self.draw_text(<span class="string">"Congratulations !"</span>, <span class="number">48</span>, WHITE, WIDTH * <span class="number">0.5</span>, HEIGHT * <span class="number">0.25</span>)</span><br><span class="line">        self.draw_text(<span class="string">"Score: "</span> + str(self.score), <span class="number">22</span>, WHITE, WIDTH * <span class="number">0.5</span>, HEIGHT * <span class="number">0.5</span>)</span><br><span class="line">        self.draw_text(<span class="string">"Press a key to play again"</span>, <span class="number">22</span>, WHITE, WIDTH * <span class="number">0.5</span>, HEIGHT * <span class="number">0.75</span>)</span><br><span class="line">        pg.display.flip()</span><br><span class="line">        self.wait_for_key()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">wait_for_key</span><span class="params">(self)</span>:</span></span><br><span class="line">        self.waiting = <span class="literal">True</span></span><br><span class="line">        <span class="keyword">while</span> self.waiting:</span><br><span class="line">            self.clock.tick(FPS)</span><br><span class="line">            <span class="keyword">for</span> event <span class="keyword">in</span> pg.event.get():</span><br><span class="line">                <span class="keyword">if</span> event.type == pg.QUIT:</span><br><span class="line">                    self.waiting = <span class="literal">False</span></span><br><span class="line">                    self.running = <span class="literal">False</span></span><br><span class="line">                <span class="keyword">if</span> event.type == pg.KEYDOWN:</span><br><span class="line">                    self.waiting = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">draw_text</span><span class="params">(self, text, size, color, x, y)</span>:</span></span><br><span class="line">        font = pg.font.SysFont(<span class="string">"arial"</span>, size)</span><br><span class="line">        text_surface = font.render(text, <span class="literal">True</span>, color)</span><br><span class="line">        text_rect = text_surface.get_rect()</span><br><span class="line">        text_rect.midtop = (int(x), int(y))</span><br><span class="line">        self.screen.blit(text_surface, text_rect)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">g = Game()</span><br><span class="line">g.show_start_screen()</span><br><span class="line"><span class="keyword">while</span> g.running:</span><br><span class="line">    g.new()</span><br><span class="line">    g.show_go_screen()</span><br></pre></td></tr></table></figure>



<h3 id="sprites-py"><a href="#sprites-py" class="headerlink" title="sprites.py"></a>sprites.py</h3>  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> settings <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> pygame <span class="keyword">as</span> pg</span><br><span class="line"></span><br><span class="line">vec = pg.math.Vector2</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Player</span><span class="params">(pg.sprite.Sprite)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, game)</span>:</span></span><br><span class="line">        pg.sprite.Sprite.__init__(self)</span><br><span class="line">        self.game = game</span><br><span class="line">        self.jumping = <span class="literal">False</span></span><br><span class="line">        self.image = pg.Surface((<span class="number">30</span>, <span class="number">40</span>))</span><br><span class="line">        self.image.fill(YELLOW)</span><br><span class="line">        self.rect = self.image.get_rect()</span><br><span class="line">        self.rect.center = (WIDTH / <span class="number">2</span>, HEIGHT / <span class="number">2</span>)</span><br><span class="line">        self.pos = vec(WIDTH / <span class="number">2</span>, HEIGHT / <span class="number">2</span>)</span><br><span class="line">        self.vel = vec(<span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line">        self.acc = vec(<span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">jump</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> self.jumping:</span><br><span class="line">            self.jumping = <span class="literal">True</span></span><br><span class="line">            self.vel.y = -PLAYER_JUMP</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">jump_cut</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> self.jumping:</span><br><span class="line">            <span class="keyword">if</span> self.vel.y &lt; <span class="number">-3</span>:</span><br><span class="line">                self.vel.y = <span class="number">-3</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">update</span><span class="params">(self)</span>:</span></span><br><span class="line">        self.acc = vec(<span class="number">0</span>, PLAYER_GRAVITY)</span><br><span class="line">        keys = pg.key.get_pressed()</span><br><span class="line">        <span class="keyword">if</span> keys[pg.K_LEFT]:</span><br><span class="line">            self.acc.x = -PLAYER_ACC</span><br><span class="line">        <span class="keyword">if</span> keys[pg.K_RIGHT]:</span><br><span class="line">            self.acc.x = PLAYER_ACC</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 增加摩擦</span></span><br><span class="line">        self.acc.x += self.vel.x * PLAYER_FRICTION</span><br><span class="line">        <span class="comment"># 移动公式</span></span><br><span class="line">        self.vel += self.acc</span><br><span class="line">        self.pos += self.vel + <span class="number">0.5</span> * self.acc</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> self.pos.x &gt; WIDTH:</span><br><span class="line">            self.pos.x = <span class="number">0</span></span><br><span class="line">        <span class="keyword">if</span> self.pos.x &lt; <span class="number">0</span>:</span><br><span class="line">            self.pos.x = WIDTH</span><br><span class="line"></span><br><span class="line">        self.rect.midbottom = self.pos</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Platform</span><span class="params">(pg.sprite.Sprite)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, x, y, w, h)</span>:</span></span><br><span class="line">        pg.sprite.Sprite.__init__(self)</span><br><span class="line">        self.image = pg.Surface((w, h))</span><br><span class="line">        self.image.fill(GREEN)</span><br><span class="line">        self.rect = self.image.get_rect()</span><br><span class="line">        self.rect.x = x</span><br><span class="line">        self.rect.y = y</span><br></pre></td></tr></table></figure>

<h3 id="settings-py"><a href="#settings-py" class="headerlink" title="settings.py"></a>settings.py</h3>  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">TITLE = <span class="string">"Jumpy !"</span></span><br><span class="line"><span class="comment"># 定义窗口大小</span></span><br><span class="line">WIDTH = <span class="number">400</span></span><br><span class="line">HEIGHT = <span class="number">600</span></span><br><span class="line">FPS = <span class="number">60</span></span><br><span class="line"></span><br><span class="line">PLAYER_ACC = <span class="number">0.5</span></span><br><span class="line">PLAYER_FRICTION = <span class="number">-0.12</span></span><br><span class="line">PLAYER_GRAVITY = <span class="number">0.8</span></span><br><span class="line">PLAYER_JUMP = <span class="number">20</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义颜色</span></span><br><span class="line">WHITE = (<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>)</span><br><span class="line">BLACK = (<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line">RED = (<span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line">GREEN = (<span class="number">0</span>, <span class="number">255</span>, <span class="number">0</span>)</span><br><span class="line">BLUE = (<span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>)</span><br><span class="line">YELLOW = (<span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>)</span><br><span class="line">BACKGROUND_COLOR = (<span class="number">0</span>, <span class="number">155</span>, <span class="number">155</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 平面</span></span><br><span class="line">PLATFORM_LIST = [(WIDTH / <span class="number">2</span> - <span class="number">30</span>, HEIGHT * <span class="number">0.8</span>, <span class="number">150</span>, <span class="number">20</span>),</span><br><span class="line">                 (<span class="number">25</span>, HEIGHT - <span class="number">350</span>, <span class="number">100</span>, <span class="number">20</span>),</span><br><span class="line">                 (<span class="number">350</span>, <span class="number">200</span>, <span class="number">100</span>, <span class="number">20</span>),</span><br><span class="line">                 (<span class="number">175</span>, <span class="number">100</span>, <span class="number">50</span>, <span class="number">20</span>)]</span><br></pre></td></tr></table></figure>

</div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">丁生</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="">http://fabian4.gitee.io/12739.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="javascript:;" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="index.html" target="_blank">丁生的个人博客</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="index5.html">python</a><a class="post-meta__tags" href="index6.html">pygame</a></div><div class="post_share"><div class="social-share" data-image="https://i.loli.net/2020/05/07/WGjQk25ap7NhlUS.jpg" data-sites="wechat,weibo,qq,qzone"></div><link rel="stylesheet" href="static/css/share.min.css"><script src="static/js/social-share.min.js"></script></div></div><div class="post-reward"><a class="reward-button button--primary button--animated"> <i class="fa fa-qrcode"></i> 打赏<div class="reward-main"><ul class="reward-all"><li class="reward-item"><img class="lazyload post-qr-code__img" src="static/picture/h3WuUjvQlqPEAzS.png" alt="微信"><div class="post-qr-code__desc">微信</div></li><li class="reward-item"><img class="lazyload post-qr-code__img" src="static/picture/9yaek4PwfNoZEHF.jpg" alt="支付宝"><div class="post-qr-code__desc">支付宝</div></li></ul></div></a></div><nav class="pagination_post" id="pagination"><div class="prev-post pull_left"><a href="12400.html"><img class="prev_cover lazyload" data-src="https://i.loli.net/2020/04/28/mtUT9iSPeX8YJav.jpg" onerror="onerror=null;src='https://i.loli.net/2020/04/24/MZwypBlWXcPu6aT.jpg'"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">pygame常用函数</div></div></a></div><div class="next-post pull_right"><a href="64086.html"><img class="next_cover lazyload" data-src="https://i.loli.net/2020/05/02/jIymExY7egrNou6.jpg" onerror="onerror=null;src='https://i.loli.net/2020/04/24/MZwypBlWXcPu6aT.jpg'"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">白嫖阿里——搭建自己的个人服务器</div></div></a></div></nav><div class="relatedPosts"><div class="relatedPosts_headline"><i class="fa fa-fw fa-thumbs-up" aria-hidden="true"></i><span> 相关推荐</span></div><div class="relatedPosts_list"><div class="relatedPosts_item"><a href="2041.html" title="超级玛丽的 python 实现"><img class="relatedPosts_cover lazyload" data-src="https://i.loli.net/2020/04/29/cR1JOeNEmYnCBHt.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-04-29</div><div class="relatedPosts_title">超级玛丽的 python 实现</div></div></a></div><div class="relatedPosts_item"><a href="12400.html" title="pygame常用函数"><img class="relatedPosts_cover lazyload" data-src="https://i.loli.net/2020/04/28/mtUT9iSPeX8YJav.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-04-28</div><div class="relatedPosts_title">pygame常用函数</div></div></a></div><div class="relatedPosts_item"><a href="49637.html" title="Django 的快速上手"><img class="relatedPosts_cover lazyload" data-src="https://i.loli.net/2020/04/30/tWpPXKnCBcsfY76.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-04-30</div><div class="relatedPosts_title">Django 的快速上手</div></div></a></div><div class="relatedPosts_item"><a href="55582.html" title="Django 的数据库操作"><img class="relatedPosts_cover lazyload" data-src="static/picture/rt4ubo7Phv38CmZ.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-05-01</div><div class="relatedPosts_title">Django 的数据库操作</div></div></a></div><div class="relatedPosts_item"><a href="47578.html" title="Django 的员工信息系统"><img class="relatedPosts_cover lazyload" data-src="https://i.loli.net/2020/05/07/WGjQk25ap7NhlUS.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-05-03</div><div class="relatedPosts_title">Django 的员工信息系统</div></div></a></div></div><div class="clear_both"></div></div><hr><div id="post-comment"><div class="comment_headling"><i class="fa fa-comments fa-fw" aria-hidden="true"></i><span> 评论</span></div><div class="vcomment" id="vcomment"></div><script src="static/js/Valine.min.js"></script><script>var GUEST_INFO = ['nick','mail','link'];
var guest_info = 'nick'.split(',').filter(function(item){
  return GUEST_INFO.indexOf(item) > -1
});
guest_info = guest_info.length == 0 ? GUEST_INFO :guest_info;

window.valine = new Valine({
  el:'#vcomment',
  notify: false,
  verify: false,
  appId: 'cjbkGguzmuIOFaSfn7miKri5-gzGzoHsz',
  appKey: 'tbNXCYd7AaxYAvjBoBfhFSNx',
  placeholder: '留下你的评论吧！',
  avatar: 'robohash',
  meta: guest_info,
  pageSize: '5',
  lang: 'zh-cn',
  recordIP: false,
  serverURLs: ''
});</script></div></article></main><footer id="footer" style="background-image: url(static/image/FmqHTOS6Nz4b9jo.jpg)" data-type="photo"><div id="footer-wrap"><div class="copyright">&copy;2020 By 丁生</div><div class="footer_custom_text">Hi, welcome to my <a href="index.html">blog</a>!</div></div></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><i class="fa fa-book" id="readmode" title="阅读模式"></i><i class="fa fa-plus" id="font_plus" title="放大字体"></i><i class="fa fa-minus" id="font_minus" title="缩小字体"></i><a class="translate_chn_to_cht" id="translateLink" href="javascript:translatePage();" title="简繁转换" target="_self">简</a><i class="darkmode fa fa-moon-o" id="darkmode" title="夜间模式"></i></div><div id="rightside-config-show"><div id="rightside_config" title="设置"><i class="fa fa-cog" aria-hidden="true"></i></div><a id="to_comment" href="#post-comment" title="直达评论"><i class="scroll_to_comment fa fa-comments">  </i></a><i class="fa fa-list-ul close" id="mobile-toc-button" title="目录" aria-hidden="true"></i><i class="fa fa-arrow-up" id="go-up" title="回到顶部" aria-hidden="true"></i></div></section><script src="static/js/jquery.min.js"></script><script src="static/js/utils.js"></script><script src="static/js/main.js"></script><script src="static/js/main.js"></script><script src="static/js/jquery.fancybox.min.js"></script><script src="static/js/snackbar.min.js"></script><script id="canvas_nest" color="0,0,255" opacity="0.7" zindex="-1" count="99" mobile="false" src="static/js/main.js"></script><script async="" src="static/js/busuanzi.pure.mini.js"></script><script src="static/js/instantpage.min.js" type="module"></script><script src="static/js/lazysizes.min.js" async=""></script><script src="static/js/main.js"></script></body></html>